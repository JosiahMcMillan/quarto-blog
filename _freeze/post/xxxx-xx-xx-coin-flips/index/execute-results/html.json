{
  "hash": "19c20392751d934e03c0da0fabcf3972",
  "result": {
    "markdown": "---\ntitle: \"a worked hypothesis testing problem\"\nsubtitle: |\n  some pointers on things that can go right and wrong\ndate: \"TODO\"\ncategories: [hypothesis testing, frequentism, p-hacking]\ndraft: true\nfig-width: 10\nfig-height: 6\n---\n\n\nIn an data science course that I am currently TA-ing, we just gave out the following problem.\n\nSuppose you have the following six sequences of coin flips. Exactly one sequence is generated by repeatedly flipping a fair coin. Which sequence is it?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsequences <- c(\n  A = \"HTHTHTHTHTHTHTHTHTHTHTHTHTHTHTHTHHTHTHTHTHTHTHTTHTHTHTHTHTHTHHTHTHTHTHTHTHTHTHTHTHTHTHTHTHHTTHTHTHTHTHTHTHTHTHTHTHTHTHHTHTHTHTHTHTHTHTHTHTHTHTTHTHTHTHTHTHTHTHTHTHTHTHTHHTHTHTHTHTHTHTHTHTHTHTHHTHTHTHTH\",\n  B = \"HHHTHTTTHHTHHTHHHTTTTHTHTHHTTHTHHHTHHTHTTTHTHHHTHTTTHTHTHHTHTHTTHTHHTHTHTTTHTHHHTHTHTTHTHTHHTHTHTHHHTHTTTHTHHTHTHTHHTTTHTHHTHHTTTTHTHTHHHTHTTHTHHTHTHTTHTHHTHTHHHTHHHTHTTTHTTHTTTHTHHHTHTHTTHTHHTHHTHTTT\",\n  C = \"HHTHTHTTTHTHHHTHHTTTHTHHTHTTTHTHTHHTHTHTTHTHHHHHHTTTHTHTHHTHTTTHTHHTHTHTTTHTHHHTTHTTTHTHTHHHHTHTTHHTTTTTHTHHHTHTHTTTTTHHHTHHTHHTHHHTTTTHTHTHHHTHHTTTTTHTHHHTHTHTHTTTHTHHHTHTHTHTTHTHHTHTHTHTTTTHTHHHTHTH\",\n  D = \"HTHHHHHHHTHTTHHTTHHHTHTHTTTHHTHHHTHHTTHTTTTTTTTTHTHHTTTTTHTHTHTHHTTHTTHTTTTTHHHTHTTTHTHTHHHTHTTTTHTHTHHTTHTHTTHHTHTHHHHTHTTHHTTHTTHTTHTHHHHHHTTTTTTHHHTTHTHHHHTTTHTTHHHTTHTHHTTTHHTHHTTTHTHHTHHHTHHTTHHH\",\n  E = \"HHHHHHHHHHHTTTTTTTTTTTHHHHHHHHHHHHTTTTTTTTTTTHHHHHHHHHHHHHTTTTTTTTTTHHHHHHHHHHTTTTTTTTHHHHHHHHTTTTTTTHHHHHHHHHTTTTTTTTTHHHHHHHHTTTHHHHHHHHHHHTTTTTTTTTTTHHHHHHHHHHHHTTTTTTTTTTTHHHHHHHHHHHHHTTTTTTTTTTHH\",\n  F = \"TTHTTTHTTTTTTTHTHTHTHTTHTTHTHHTHHTTTHHTHTTTHTHHTHHHTHTTHHTHHTTHTHTTTTHTHTTTHHTTTTTTTTHTHHTTHTTTTTTHTHTHTHTTTHTTHHTTHTTTHHTTTHTTHTTTTHTTTTHHTTTHTHTHHHTTTTTTHTHHTTTTTTTTTTTTHHHTTTHHHTTTHTTTHTHTTHTTTTTHT\"\n)\n```\n:::\n\n\nTo make the problem a little more concrete, here is a visualization of the coin flip sequences. Which one looks genuinely random to you? Try to solve this problem on your own before reading on!\n\n\n::: {.cell .column-body-outset}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(tidyverse)\nlibrary(glue)\n\ntheme_set(theme_classic(16))\n\nobserved_nested <- tibble(\n  name = glue(\"Seq {LETTERS[1:6]}\"),\n  sequence = sequences\n) |> \n  mutate(\n    result = str_split(sequence, \"\")\n  )\n\nobserved_long <- observed_nested  |> \n  select(-sequence) |> \n  unnest(c(result)) |> \n  group_by(name) |> \n  mutate(\n    index = row_number()\n  )\n\nobserved_long |> \n  ggplot(aes(x = index, y = result, group = name)) +\n  geom_line(color = \"grey\") +\n  geom_point(aes(color = result)) +\n  scale_color_brewer(type = \"qual\") +\n  facet_grid(rows = vars(name)) +\n  labs(\n    title = \"Sequences of coin flips\",\n    subtitle = \"Only one sequence was generated from fair and dependent coin flips\",\n    caption = \"Each sequence consists of 200 results, either 'heads' or 'tails'\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    axis.title = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![Sequences A, B, C, D, E and F. Only one sequence was generated randomly using a fair coin.](index_files/figure-html/fig-observed-1.png){#fig-observed width=960}\n:::\n:::\n\n\n## Eye-balling it\n\nStaring at the sequences, I notice a couple things at first:\n\n-   `A` always alternates between heads and tails, on every single flip\n-   `E` stays heads for a long time, then switches to tails for a long time, and then the cycle repeats\n-   All of the other cycles switch back and forth between heads and tails fairly often, with some long streaks of all heads or all tails as well\n\nImmediately I think I can rule out `A` and `E`, because each flip appears to depend on the previous flips, and this shouldn't happen when I repeatedly flip a fair coin. Hopefully, I can develop a test later on that will capture this intuition more quantitatively, but for now, I just rule out `A` and `E`.\n\nThere are some other patterns that look suspicious to me, but I've previously learned that my intuition about which sequences are random and which aren't isn't very good. Part of the challenge here is that I am mainly looking at non-random sequences in @fig-observed, and this doesn't tell me very much about which patterns are surprising under a random model. So next I generate six sequences by repeatedly flipping a fair coin (from this point onward, when I refer to a \"random sequence\", I mean sequence of heads and tails generated by repeatedly flipping a fair coin just like this).\n\n\n::: {.cell .column-body-outset}\n\n```{.r .cell-code  code-fold=\"true\"}\nset.seed(27)\n\nsample_sequence <- function() {\n  outcomes <- c(\"H\", \"T\")\n  sample(outcomes, size = 200, replace = TRUE)\n}\n\nnum_samples <- 6\n\nlong_fair <- tibble(\n  result = map(1:num_samples, \\(x) sample_sequence())\n) |> \n  mutate(\n    name = glue(\"Fair {LETTERS[1:num_samples]}\")\n  ) |> \n  unnest(c(result)) |> \n  group_by(name) |> \n  mutate(\n    index = row_number()\n  )\n\nlong_fair |> \n  ggplot(aes(x = index, y = result, group = name)) +\n  geom_line(color = \"grey\") +\n  geom_point(aes(color = result)) +\n  scale_color_brewer(type = \"qual\") +\n  facet_grid(rows = vars(name)) +\n  labs(\n    title = \"Sequences of coin flips\",\n    subtitle = \"Every sequence was generated generated from fair and dependent coin flips\",\n    caption = \"Each sequence consists of 200 results, either 'heads' or 'tails'\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    axis.title = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![Six sequences sampled by repeatedly flipping a fair coin, for comparison.](index_files/figure-html/fig-fair-1.png){#fig-fair width=960}\n:::\n:::\n\n\nIn light of these fair sequences, I can't really eye-ball anything else that looks suspicious.\n\n## Counting heads\n\nThe next thing that comes to mind is that, if a coin is fair, then roughly half the flips should be heads and half should be tails. Since I know how to simulate sequences of repeatedly flipped fair coins, I'll generate a bunch of sequences from this null model, and then compare the number of heads in the observed sequences to the number of heads in the simulated sequences.\n\n\n::: {.cell .column-body-outset}\n\n```{.r .cell-code  code-fold=\"true\"}\ncount_heads <- function(results) {\n  sum(results == \"H\")\n}\n\nsample_statistic_under_null <- function(test_statistic, num_samples = 1000) {\n  map_dbl(1:num_samples, \\(x) test_statistic(sample_sequence()))\n}\n\nnull_distribution <- sample_statistic_under_null(count_heads)\n\nobserved_statistics <- observed_nested |> \n  mutate(\n    statistic = map_dbl(result, count_heads)\n  ) |> \n  select(name, statistic)\n\nobserved_statistics |> \n  mutate(\n    null_sample = list(null_distribution)\n  ) |> \n  unnest(c(null_sample)) |> \n  ggplot(aes(x = null_sample)) +\n  geom_histogram(\n    binwidth = 1,\n    center = 0\n  ) +\n  geom_vline(aes(xintercept = statistic, color = name)) +\n  facet_wrap(\n    vars(name),\n    scales = \"free\",\n    nrow = 1\n  ) +\n  scale_color_brewer(palette = \"Dark2\") +\n  scale_x_continuous(breaks = c(80, 100, 120)) +\n  labs(\n    title = \"Number of heads in each sequence\",\n    subtitle = \"compare to number of heads in random sequences (grey)\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    axis.title = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=960}\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\nci <- quantile(null_distribution, c(0.05, 0.95))\n```\n:::\n\n\nBy looking at the grey histogram (which is repeated in each panel), I can observed that, in ninety percent of the sequences from a repeatedly flipped fair coin, the number of heads in the sequence is between the fifth percentile $q_{0.05} =$ 89 and the ninety-fifth percentile $q_{0.95} =$ 111. This means that it is *unlikely* that I will see less than 89 heads or more than 111 heads in a random sequence.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(gt)\n\nhead_count_stats <- observed_statistics |> \n  mutate(\n    expected = mean(null_distribution),\n    observed_quantile = map_dbl(statistic, \\(stat) ecdf(null_distribution)(stat)),\n    p_value = pmin(observed_quantile, 1 - observed_quantile),\n    likelihood = 0.5^200,\n    log_likelihood = 200 * log(0.5)\n  )\n\nhead_count_stats |> \n  select(name, statistic) |> \n  gt() |> \n  cols_label(\n    name = \"Sequence\",\n    statistic = \"Heads in sequence\"\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"debvpofyig\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#debvpofyig .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#debvpofyig .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#debvpofyig .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#debvpofyig .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#debvpofyig .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#debvpofyig .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#debvpofyig .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#debvpofyig .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#debvpofyig .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#debvpofyig .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#debvpofyig .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#debvpofyig .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#debvpofyig .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#debvpofyig .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#debvpofyig .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#debvpofyig .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#debvpofyig .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#debvpofyig .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#debvpofyig .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#debvpofyig .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#debvpofyig .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#debvpofyig .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#debvpofyig .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#debvpofyig .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#debvpofyig .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#debvpofyig .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#debvpofyig .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#debvpofyig .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#debvpofyig .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#debvpofyig .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#debvpofyig .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#debvpofyig .gt_left {\n  text-align: left;\n}\n\n#debvpofyig .gt_center {\n  text-align: center;\n}\n\n#debvpofyig .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#debvpofyig .gt_font_normal {\n  font-weight: normal;\n}\n\n#debvpofyig .gt_font_bold {\n  font-weight: bold;\n}\n\n#debvpofyig .gt_font_italic {\n  font-style: italic;\n}\n\n#debvpofyig .gt_super {\n  font-size: 65%;\n}\n\n#debvpofyig .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#debvpofyig .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#debvpofyig .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#debvpofyig .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#debvpofyig .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#debvpofyig .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#debvpofyig .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sequence\">Sequence</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Heads in sequence\">Heads in sequence</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq A</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">102</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq B</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">102</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq C</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">100</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq D</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">99</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq E</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">109</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq F</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">70</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nSince sequence F has only 70 heads, it seems unlikely that sequence F comes from the null model of independent, fair coin flips.\n\nThe approach that I have demonstrated above is to compute a *rejection region* for a test statistic that contains my test statistic $90\\%$ of the time under the null model. This is not the only way to approach the problem. I could also ask, for each sequence, how often do I see a larger number of heads in random sequences. This is known as computing a *p-value*.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nhead_count_stats |> \n  select(name, p_value) |> \n  gt() |> \n  cols_label(\n    name = \"Sequence\",\n    p_value = \"P-value\"\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"fdnmgbldmw\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#fdnmgbldmw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fdnmgbldmw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fdnmgbldmw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fdnmgbldmw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fdnmgbldmw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fdnmgbldmw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fdnmgbldmw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fdnmgbldmw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fdnmgbldmw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fdnmgbldmw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fdnmgbldmw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fdnmgbldmw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fdnmgbldmw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fdnmgbldmw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fdnmgbldmw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fdnmgbldmw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fdnmgbldmw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fdnmgbldmw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fdnmgbldmw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fdnmgbldmw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fdnmgbldmw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fdnmgbldmw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fdnmgbldmw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fdnmgbldmw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fdnmgbldmw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fdnmgbldmw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fdnmgbldmw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fdnmgbldmw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fdnmgbldmw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fdnmgbldmw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fdnmgbldmw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fdnmgbldmw .gt_left {\n  text-align: left;\n}\n\n#fdnmgbldmw .gt_center {\n  text-align: center;\n}\n\n#fdnmgbldmw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fdnmgbldmw .gt_font_normal {\n  font-weight: normal;\n}\n\n#fdnmgbldmw .gt_font_bold {\n  font-weight: bold;\n}\n\n#fdnmgbldmw .gt_font_italic {\n  font-style: italic;\n}\n\n#fdnmgbldmw .gt_super {\n  font-size: 65%;\n}\n\n#fdnmgbldmw .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#fdnmgbldmw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fdnmgbldmw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fdnmgbldmw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fdnmgbldmw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fdnmgbldmw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fdnmgbldmw .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sequence\">Sequence</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"P-value\">P-value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq A</td>\n<td headers=\"p_value\" class=\"gt_row gt_right\">0.349</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq B</td>\n<td headers=\"p_value\" class=\"gt_row gt_right\">0.349</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq C</td>\n<td headers=\"p_value\" class=\"gt_row gt_right\">0.484</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq D</td>\n<td headers=\"p_value\" class=\"gt_row gt_right\">0.466</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq E</td>\n<td headers=\"p_value\" class=\"gt_row gt_right\">0.082</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq F</td>\n<td headers=\"p_value\" class=\"gt_row gt_right\">0.000</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nWhen the p-value is small, it means that the number of observed heads in a sequence is either much higher or much lower than typically seen in random sequences. In particular, a p-value of $p$ (which should always be between zero and one) means that random sequences had as many heads as the mystery sequence only $p \\cdot 100\\%$ of the time.\n\nMore intuitively: small p-values indicate that data is not compatible with a given model. In this case, the very small p-value for sequence $F$ indicates that sequence $F$ is not compatible the random sequence model for coin flips. Sequences $A, B, C, D$ and to a less extent $E$ are all compatible with the random sequence model.\n\n\n:::callout-warning\n### Misleading intuition\n\nIf we stare at the p-values a little longer, we might be tempted to conclude that sequence $C$ is the most likely to be sampled from the random model, since it has the highest p-value. The intuition goes roughly like this: a low p-value tells us that it is improbable that the data $X_1, ..., X_n$ came from the null model. Therefore a high p-value tells us that is probable the data $X_1, ..., X_n$ came from the null model.\n\nThis is a very common misconception, and if we are a little bit more careful in interpreting the p-value, we can see where it comes from, and also why this reasoning doesn't quite work. More precisely, low p-value tells us that it is improbable that the observed test statistic $T(X_1, ..., X_n)$ would be observed by chance under the null model. The probability of seeing the test statistic is *not* the probability of seeing the data.\n\nDifferent test statistics can be used to examine the compatibility of the data with different aspects of the null model! One test statistic might have a small p-value, and a different test statistic might have a large p-value, both for the same null model.\n\nBecause hypothesis tests function through a test statistic, we cannot use them to compare the relative probability of hypotheses. To make this slightly more concrete, let's compute the probability of observing sequences $A, B, C, D, E$ and $F$ under the null model. This turns out to be $(1/2)^{200}$ for every single sequence. Under the null model, every single sequence is equally likely!\n\nTakeaways:\n\n1. P-values tell us about the probability of the test statistic, not the data.\n2. This means we need to pick good test statistics, which is generally a challenging problem.\n3. The data can be compatible with multiple models at the same time!\n\nrain example?\n\nreject vs accept vs fail to reject. sometime framed as: cannot \"accept\" the null hypothesis, can only reject it\n\nSimilarly, if we compute the expected number of heads under the null model, we cannot conclude that sequence $C$ is the most likely. Having a sample mean close to a population mean does not tell us about probability of the data under the null.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nhead_count_stats |> \n  select(-p_value, -observed_quantile, -likelihood) |> \n  gt() |> \n  cols_label(\n    name = \"Sequence\",\n    statistic = \"Heads in sequence\",\n    expected = \"E[num heads|null model]\",\n    log_likelihood = \"log P(data|null model)\"\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"zwuobxtlof\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#zwuobxtlof .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zwuobxtlof .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zwuobxtlof .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zwuobxtlof .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zwuobxtlof .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwuobxtlof .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zwuobxtlof .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zwuobxtlof .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zwuobxtlof .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zwuobxtlof .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zwuobxtlof .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zwuobxtlof .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zwuobxtlof .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zwuobxtlof .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zwuobxtlof .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zwuobxtlof .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zwuobxtlof .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwuobxtlof .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zwuobxtlof .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zwuobxtlof .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwuobxtlof .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zwuobxtlof .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zwuobxtlof .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwuobxtlof .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwuobxtlof .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zwuobxtlof .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zwuobxtlof .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwuobxtlof .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zwuobxtlof .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwuobxtlof .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zwuobxtlof .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwuobxtlof .gt_left {\n  text-align: left;\n}\n\n#zwuobxtlof .gt_center {\n  text-align: center;\n}\n\n#zwuobxtlof .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zwuobxtlof .gt_font_normal {\n  font-weight: normal;\n}\n\n#zwuobxtlof .gt_font_bold {\n  font-weight: bold;\n}\n\n#zwuobxtlof .gt_font_italic {\n  font-style: italic;\n}\n\n#zwuobxtlof .gt_super {\n  font-size: 65%;\n}\n\n#zwuobxtlof .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#zwuobxtlof .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zwuobxtlof .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zwuobxtlof .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zwuobxtlof .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zwuobxtlof .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zwuobxtlof .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sequence\">Sequence</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Heads in sequence\">Heads in sequence</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"E[num heads|null model]\">E[num heads|null model]</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"log P(data|null model)\">log P(data|null model)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq A</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">102</td>\n<td headers=\"expected\" class=\"gt_row gt_right\">100.1</td>\n<td headers=\"log_likelihood\" class=\"gt_row gt_right\">-138.6294</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq B</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">102</td>\n<td headers=\"expected\" class=\"gt_row gt_right\">100.1</td>\n<td headers=\"log_likelihood\" class=\"gt_row gt_right\">-138.6294</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq C</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">100</td>\n<td headers=\"expected\" class=\"gt_row gt_right\">100.1</td>\n<td headers=\"log_likelihood\" class=\"gt_row gt_right\">-138.6294</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq D</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">99</td>\n<td headers=\"expected\" class=\"gt_row gt_right\">100.1</td>\n<td headers=\"log_likelihood\" class=\"gt_row gt_right\">-138.6294</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq E</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">109</td>\n<td headers=\"expected\" class=\"gt_row gt_right\">100.1</td>\n<td headers=\"log_likelihood\" class=\"gt_row gt_right\">-138.6294</td></tr>\n    <tr><td headers=\"name\" class=\"gt_row gt_center\">Seq F</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">70</td>\n<td headers=\"expected\" class=\"gt_row gt_right\">100.1</td>\n<td headers=\"log_likelihood\" class=\"gt_row gt_right\">-138.6294</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n:::\n\n## Longest streak of heads in a row\n\ntried one test, time to develop another one. let's try streaks. how do i come up with this as a test statistic? by looking at the data? actually, no, more know that streak lengths are a defining feature of binary random sequences a priori. using a priori knowledge to develop tests is typically a good thing.\n\n\n::: {.cell .column-body-outset}\n\n```{.r .cell-code  code-fold=\"true\"}\nplot_test <- function(test_statistic) {\n  \n  null_distribution <- sample_statistic_under_null(test_statistic)\n  \n  observed_statistics <- observed_nested |> \n    mutate(\n      statistic = map_dbl(result, test_statistic)\n    ) |> \n    select(name, statistic)\n  \n  observed_statistics |> \n    mutate(\n      null_sample = list(null_distribution)\n    ) |> \n    unnest(c(null_sample)) |> \n    ggplot(aes(x = null_sample)) +\n    geom_histogram(\n      binwidth = 1,\n      center = 0\n    ) +\n    geom_vline(aes(xintercept = statistic, color = name)) +\n    facet_wrap(\n      vars(name),\n      scales = \"free\",\n      nrow = 1\n    ) +\n    scale_color_brewer(palette = \"Dark2\") +\n    theme(\n      legend.position = \"none\",\n      axis.title = element_blank()\n    )\n}  \n\nlongest_heads_subsequence <- function(results) {\n  rle_encoded <- rle(results)\n  head_sequence_indicators <- rle_encoded$values == \"H\"\n  \n  if (!any(head_sequence_indicators)) {\n    warning(\"No head sequences!\")\n    return(NA)\n  }\n  \n  heads_seq_lengths <- rle_encoded$lengths[head_sequence_indicators]\n  max(heads_seq_lengths)\n}\n\nplot_test(longest_heads_subsequence) +\n  labs(\n    title = \"Longest streak of heads in each sequence\",\n    subtitle = \"compare to longest streaks of heads in random sequences (grey)\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=960}\n:::\n:::\n\n\nNow we're down to sequences $C$ and $D$ as viable. $C$ has exactly 100 heads, $D$ does not. Is this suspicious? I leave it for you to find out.\n\n## Some suspicious patterns\n\n> I found out that the probability of \"HHHHHHTTTTTT\" occurring 1 or more times in 200 flips is smaller than 0.05, so I decided to eliminate flips4. So we now have flips2 and flips3 left.\n\n\n::: {.cell .column-body-outset}\n\n```{.r .cell-code  code-fold=\"true\"}\n# HTHHHHHHTTTTTTHHHTTHTHHHHTTTH\n# HHHHHHTTTTTT\nnum_subseq <- function(results, subseq) {\n  collapsed <- paste0(results, collapse = \"\")\n  str_count(collapsed, subseq)\n}\n\npattern1_count <- function(results) {\n  num_subseq(results, subseq = \"HTHHHHHHTTTTTTHHHTTHTHHHHTTTH\")\n}\n\nplot_test(pattern1_count) +\n  labs(\n    title = \"Frequency of sequence HTHHHHHHTTTTTTHHHTTHTHHHHTTTH\",\n    subtitle = \"compare to frequency under null model (grey)\"\n  ) +\n  scale_x_continuous(breaks = 0:1, expand = 0:1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=960}\n:::\n:::\n\n\nSo we reject sequence $D$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnum_islands <- function(results) {\n  rle_encoded <- rle(results)\n  sum(table(rle_encoded$lengths))\n}\n\nmatches <- function(results) {\n  sum(results == dplyr::lag(results), na.rm = TRUE)\n}\n\nplot_test(num_islands) +\n  labs(\n    title = \"Number of islands\",\n    subtitle = \"compare to frequency under null model (grey)\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=960}\n:::\n\n```{.r .cell-code}\nplot_test(matches) +\n  labs(\n    title = \"Number of matches\",\n    subtitle = \"compare to frequency under null model (grey)\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-2.png){width=960}\n:::\n:::\n\n\nbut we also reject sequence $C$! welcome to testing hell. what is going on here. all data has surprising variation.\n\nlooking at it, seeing something surprising, and then testing if that variation is surprising can lead you astray. this is called p-hacking.\n\nTo avoid this problem, do you think it is sufficient to choose a test statistic before looking at your data?\n\nDo you think it is a good idea to plan an entire data analysis before looking at your actual data?\n\nwhat makes a good test statistic? i... uh... have no idea. i.e. what gives a certain procedure guarantees and other procedures no guarantees\n\nWe have come up with test statistics that reject every sequence. This cannot possibly be correct! Which sequence do you think is actually random? What tests do you feel most confident in? Why?\n\nFollow up questions:\n\nOne of the six sequences was generated by repeatedly flipping a weighted coin, with probability $p \\in (0, 1)$ of heads, where $p$ is unknown.\n\n1. Do you have any suspicions about which sequence it was? Why?\n\n2. Can you still use a similar approach to figure out find the sequence from a weighted coin? Why or why not?\n\n3. Overall, we did $X$ total hypothesis tests. Each test had a certain probability of type I error, we did not choose to conduct tests independently. Collectively, across all of our tests, what is the chance of at least one false positive result? Does this seem like a problem to you? Can you think of any solutions?\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}