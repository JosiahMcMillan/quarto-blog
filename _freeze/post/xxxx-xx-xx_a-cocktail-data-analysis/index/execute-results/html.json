{
  "hash": "7c553dd79a109e7f2e1c3b7024acd72c",
  "result": {
    "markdown": "---\ntitle: \"synthetic control: elon's tweet tanked tesla's stock\"\nsubtitle: |\n  a terse analysis of tesla stock prices and how one of elon's tweets moves them\ndate: \"2024-01-01\"\nexecute:\n  echo: false\ncategories: [data analysis]\ndraft: true\n---\n\n\n### Summary\n\nhow to use `vsp`. at the end, visualization and results takeaway for non-technical folks\n\n###\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 569 × 2\n   ingredient            n\n   <chr>             <int>\n 1 Gin                 176\n 2 Fresh lemon juice   138\n 3 Simple Syrup        115\n 4 Vodka               114\n 5 Light Rum           113\n 6 Dry Vermouth        107\n 7 Fresh Lime Juice    107\n 8 Triple Sec          107\n 9 Powdered Sugar       90\n10 Grenadine            85\n# ℹ 559 more rows\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `measure_number = parse_number(measure)`.\nCaused by warning:\n! 20 parsing failures.\nrow col expected    actual\n637  -- a number For glass\n671  -- a number For glass\n794  -- a number For glass\n878  -- a number For glass\n928  -- a number For glass\n... ... ........ .........\nSee problems(...) for more details.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 413 × 1\n   ingredient                             \n   <chr>                                  \n 1 100 proof vodka                        \n 2 151 proof rum                          \n 3 17 year old j. wray and nephew ltd. rum\n 4 7 up                                   \n 5 absinthe                               \n 6 absinthe or pastis                     \n 7 absinthe substitute                    \n 8 acai berry vodka                       \n 9 african rum                            \n10 agave nectar                           \n# ℹ 403 more rows\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3,579 × 8\n   name      category row_id ingredient_number ingredient measure measure_number\n   <chr>     <chr>     <dbl>             <dbl> <chr>      <chr>            <dbl>\n 1 Gauguin   Cocktai…      1                 1 light rum  2 oz              2   \n 2 Gauguin   Cocktai…      1                 2 passion f… 1 oz              1   \n 3 Gauguin   Cocktai…      1                 3 lemon jui… 1 oz              1   \n 4 Gauguin   Cocktai…      1                 4 lime juice 1 oz              1   \n 5 Fort Lau… Cocktai…      2                 1 light rum  1.5 oz            1.5 \n 6 Fort Lau… Cocktai…      2                 2 sweet ver… .5 oz             0.5 \n 7 Fort Lau… Cocktai…      2                 3 orange ju… .25 oz            0.25\n 8 Fort Lau… Cocktai…      2                 4 lime juice .25 oz            0.25\n 9 Apple Pie Cordial…      3                 1 apple sch… 3 oz              3   \n10 Apple Pie Cordial…      3                 2 cinnamon … 1 oz              1   \n# ℹ 3,569 more rows\n# ℹ 1 more variable: n <int>\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3,489 × 416\n   name      category     n light_rum passion_fruit_syrup lemon_juice lime_juice\n   <chr>     <chr>    <int>     <dbl>               <dbl>       <dbl>      <dbl>\n 1 Gauguin   Cocktai…   113       2                     0           0       0   \n 2 Gauguin   Cocktai…     4       0                     1           0       0   \n 3 Gauguin   Cocktai…   311       0                     0           1       0   \n 4 Gauguin   Cocktai…   180       0                     0           0       1   \n 5 Fort Lau… Cocktai…   113       1.5                   0           0       0   \n 6 Fort Lau… Cocktai…    84       0                     0           0       0   \n 7 Fort Lau… Cocktai…   124       0                     0           0       0   \n 8 Fort Lau… Cocktai…   180       0                     0           0       0.25\n 9 Apple Pie Cordial…     1       0                     0           0       0   \n10 Apple Pie Cordial…     2       0                     0           0       0   \n# ℹ 3,479 more rows\n# ℹ 409 more variables: sweet_vermouth <dbl>, orange_juice <dbl>,\n#   apple_schnapps <dbl>, cinnamon_schnapps <dbl>, powdered_sugar <dbl>,\n#   dark_rum <dbl>, cranberry_juice <dbl>, pineapple_juice <dbl>,\n#   sour_mix <dbl>, bourbon_whiskey <dbl>, simple_syrup <dbl>,\n#   soda_water <dbl>, cherry_brandy <dbl>, light_cream <dbl>, triple_sec <dbl>,\n#   maraschino <dbl>, creme_de_banana <dbl>, amaretto <dbl>, …\n```\n:::\n:::\n\n\n> The biggest difference in PC1 is powdered sugar vs. simple syrup; recipes are not likely to have both, which makes sense! Let’s zoom in on the first four components, and understand which cocktail ingredients contribute in the positive and negative directions.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'tidygraph'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: future\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3,579 × 8\n   name      category row_id ingredient_number ingredient measure measure_number\n   <chr>     <chr>     <dbl>             <dbl> <chr>      <chr>            <dbl>\n 1 Gauguin   Cocktai…      1                 1 light rum  2 oz              2   \n 2 Gauguin   Cocktai…      1                 2 passion f… 1 oz              1   \n 3 Gauguin   Cocktai…      1                 3 lemon jui… 1 oz              1   \n 4 Gauguin   Cocktai…      1                 4 lime juice 1 oz              1   \n 5 Fort Lau… Cocktai…      2                 1 light rum  1.5 oz            1.5 \n 6 Fort Lau… Cocktai…      2                 2 sweet ver… .5 oz             0.5 \n 7 Fort Lau… Cocktai…      2                 3 orange ju… .25 oz            0.25\n 8 Fort Lau… Cocktai…      2                 4 lime juice .25 oz            0.25\n 9 Apple Pie Cordial…      3                 1 apple sch… 3 oz              3   \n10 Apple Pie Cordial…      3                 2 cinnamon … 1 oz              1   \n# ℹ 3,569 more rows\n# ℹ 1 more variable: n <int>\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nVintage Sparse PCA Factor Analysis\n\nRows (n):   989\nCols (d):   413\nFactors (rank): 20\nLambda[rank]:   6.159\nComponents\n\nZ: 989 x 20 [matrix] \nB: 20 x 20 [matrix] \nY: 413 x 20 [matrix] \nu: 989 x 20 [matrix] \nd: 20      [numeric] \nv: 413 x 20 [matrix] \n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'GGally':\n  method from   \n  +.gg   ggplot2\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-4.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 60 × 3\n# Groups:   factor [20]\n   id                   factor loading\n   <chr>                <chr>    <dbl>\n 1 lemon juice          y01     20.1  \n 2 apricot brandy       y01      1.25 \n 3 anisette             y01     -0.928\n 4 dry vermouth         y02     20.1  \n 5 dark rum             y02     -0.973\n 6 green chartreuse     y02     -0.898\n 7 bitters              y03     20.0  \n 8 dark rum             y03      1.62 \n 9 white creme de cacao y03     -0.845\n10 vodka                y04     19.6  \n# ℹ 50 more rows\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n> So PC1 is about powdered sugar + egg + gin drinks vs. simple syrup + lime + tequila drinks. This is the component that explains the most variation in drinks. PC2 is mostly about vermouth, both sweet and dry.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\nhow many ingredients in each cocktail on average? \n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nWarning in left_join(get_z_hubs(fa, 5), cocktails_parsed, by = join_by(id == : Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 1 of `x` matches multiple rows in `y`.\nℹ Row 3155 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 434 × 4\n# Groups:   factor [20]\n   factor id                            ingredient     measure\n   <chr>  <chr>                         <chr>          <chr>  \n 1 z01    Thanksgiving Special Cocktail apricot brandy .75 oz \n 2 z01    Thanksgiving Special Cocktail dry gin        .75 oz \n 3 z01    Thanksgiving Special Cocktail dry vermouth   .75 oz \n 4 z01    Thanksgiving Special Cocktail lemon juice    .25 oz \n 5 z01    Western Rose Cocktail         apricot brandy .5 oz  \n 6 z01    Western Rose Cocktail         dry gin        1 oz   \n 7 z01    Western Rose Cocktail         dry vermouth   .5 oz  \n 8 z01    Western Rose Cocktail         lemon juice    .25 oz \n 9 z01    Prince's Smile Cocktail       apricot brandy .5 oz  \n10 z01    Prince's Smile Cocktail       apple brandy   .5 oz  \n# ℹ 424 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n### Normalization / scaling\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'Matrix'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n:::\n\n\n\n\nhttps://juliasilge.com/blog/cocktail-recipes-umap/",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}