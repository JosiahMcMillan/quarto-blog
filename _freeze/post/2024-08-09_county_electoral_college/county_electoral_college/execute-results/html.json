{
  "hash": "8fb1ff4823278facaa2fe764d2610873",
  "result": {
    "markdown": "---\ntitle: \"Electoral Colleges all the way down\"\nsubtitle: | \n  In which I answer a question posed on Twitter\ndate: \"2024-08-09\"\ncategories: [elections, maps]\neditor: visual\ncache: true\ndf_print: tibble\nformat: html\ncode-fold: FALSE\ncode-tools: true\nserver: shiny\n# code-link: false\n---\n\n\nhttps://x.com/MattZeitlin/status/1821195354311705043\n\n\n<!-- \n\n::: {.cell context='setup' hash='county_electoral_college_cache/html/unnamed-chunk-1_7b0e17a710c587a1daa6b2f41a513ac9'}\n\n```{.r .cell-code}\nlibrary(shiny)\nlibrary(ggplot2)\nlibrary(maps)\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(plotly)\nlibrary(fuzzyjoin)\n```\n:::\n\n::: {.cell context='data' hash='county_electoral_college_cache/html/unnamed-chunk-2_11987093ec02ecdfc1e58703b837271a'}\n\n```{.r .cell-code}\n# load data\nCounty_2020_pop <- read_excel(\"~/Downloads/co-est2023-pop.xlsx\", skip = 3)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...1`\n• `` -> `...2`\n```\n:::\n\n```{.r .cell-code}\nUS_County_Level_Presidential_Results_2020 <- read.csv(\"~/Downloads/2020_US_County_Level_Presidential_Results.csv\")\n\n# data preparation\nCounty_2020_pop$geo <- County_2020_pop$...1\nCounty_2020_pop$population <- County_2020_pop$`2020`\n\nCounty_2020_pop <- County_2020_pop %>% \n  select(geo, population) %>%\n  mutate(geo = gsub(\"^\\\\.\", \"\", geo)) %>%\n  separate(geo, into = c(\"county\", \"state\"), sep = \", \", remove = FALSE) %>%\n  drop_na()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expected 2 pieces. Additional pieces discarded in 3 rows [3146, 3147,\n3149].\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expected 2 pieces. Missing pieces filled with `NA` in 3 rows [1, 3148,\n3151].\n```\n:::\n\n```{.r .cell-code}\nPop_Votes <- left_join(US_County_Level_Presidential_Results_2020, County_2020_pop, by = c(\"county_name\"=\"county\", \"state_name\"=\"state\")) %>%\n  drop_na()\n\nstate_population_totals <- Pop_Votes %>%\n  group_by(state_name) %>%\n  summarise(total_population = sum(population, na.rm = TRUE))\n\nPop_Votes <- Pop_Votes %>%\n  left_join(state_population_totals, by = \"state_name\") %>%\n  mutate(county_population_percentage = (population / total_population) * 100) %>%\n  mutate(electoral_vote = 2 + round((county_population_percentage * 438) / 100))\n```\n:::\n\n::: {.cell hash='county_electoral_college_cache/html/unnamed-chunk-3_39a660de8148e0bb804e9b36ff6af898'}\n\n```{.r .cell-code}\nselectInput(\"state\", \"Select a State:\", choices = unique(Pop_Votes$state_name), selected = \"Alabama\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"form-group shiny-input-container\">\n<label class=\"control-label\" id=\"state-label\" for=\"state\">Select a State:</label>\n<div>\n<select id=\"state\"><option value=\"Alabama\" selected>Alabama</option>\n<option value=\"Arizona\">Arizona</option>\n<option value=\"Arkansas\">Arkansas</option>\n<option value=\"California\">California</option>\n<option value=\"Colorado\">Colorado</option>\n<option value=\"Delaware\">Delaware</option>\n<option value=\"District of Columbia\">District of Columbia</option>\n<option value=\"Florida\">Florida</option>\n<option value=\"Georgia\">Georgia</option>\n<option value=\"Hawaii\">Hawaii</option>\n<option value=\"Idaho\">Idaho</option>\n<option value=\"Illinois\">Illinois</option>\n<option value=\"Indiana\">Indiana</option>\n<option value=\"Iowa\">Iowa</option>\n<option value=\"Kansas\">Kansas</option>\n<option value=\"Kentucky\">Kentucky</option>\n<option value=\"Louisiana\">Louisiana</option>\n<option value=\"Maine\">Maine</option>\n<option value=\"Maryland\">Maryland</option>\n<option value=\"Massachusetts\">Massachusetts</option>\n<option value=\"Michigan\">Michigan</option>\n<option value=\"Minnesota\">Minnesota</option>\n<option value=\"Mississippi\">Mississippi</option>\n<option value=\"Missouri\">Missouri</option>\n<option value=\"Montana\">Montana</option>\n<option value=\"Nebraska\">Nebraska</option>\n<option value=\"Nevada\">Nevada</option>\n<option value=\"New Hampshire\">New Hampshire</option>\n<option value=\"New Jersey\">New Jersey</option>\n<option value=\"New Mexico\">New Mexico</option>\n<option value=\"New York\">New York</option>\n<option value=\"North Carolina\">North Carolina</option>\n<option value=\"North Dakota\">North Dakota</option>\n<option value=\"Ohio\">Ohio</option>\n<option value=\"Oklahoma\">Oklahoma</option>\n<option value=\"Oregon\">Oregon</option>\n<option value=\"Pennsylvania\">Pennsylvania</option>\n<option value=\"Rhode Island\">Rhode Island</option>\n<option value=\"South Carolina\">South Carolina</option>\n<option value=\"South Dakota\">South Dakota</option>\n<option value=\"Tennessee\">Tennessee</option>\n<option value=\"Texas\">Texas</option>\n<option value=\"Utah\">Utah</option>\n<option value=\"Vermont\">Vermont</option>\n<option value=\"Virginia\">Virginia</option>\n<option value=\"Washington\">Washington</option>\n<option value=\"West Virginia\">West Virginia</option>\n<option value=\"Wisconsin\">Wisconsin</option>\n<option value=\"Wyoming\">Wyoming</option></select>\n<script type=\"application/json\" data-for=\"state\" data-nonempty=\"\">{\"plugins\":[\"selectize-plugin-a11y\"]}</script>\n</div>\n</div>\n```\n:::\n:::\n\n::: {.cell hash='county_electoral_college_cache/html/unnamed-chunk-4_be4a13c6d80378ea4b190645aa89cba5'}\n\n```{.r .cell-code}\ntableOutput('data')\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"data\" class=\"shiny-html-output\"></div>\n```\n:::\n:::\n\n::: {.cell hash='county_electoral_college_cache/html/unnamed-chunk-5_2690a27ec99f60c9153174de5f276dc9'}\n\n```{.r .cell-code}\nplotOutput(\"map_plot\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"map_plot\" class=\"shiny-plot-output\" style=\"width:100%;height:400px;\"></div>\n```\n:::\n\n```{.r .cell-code}\nplotOutput(\"vote_bar\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"vote_bar\" class=\"shiny-plot-output\" style=\"width:100%;height:400px;\"></div>\n```\n:::\n:::\n\n::: {.cell context='server' hash='county_electoral_college_cache/html/unnamed-chunk-6_53144d222043de446ba141844bc6a666'}\n\n:::\n\n::: {.cell hash='county_electoral_college_cache/html/unnamed-chunk-7_2c75788efb2c49c881972247681d6982'}\n\n```{.r .cell-code}\nlibrary(shiny)\n\n# define UI dropdown that interacts with shiny server\nselectInput(\"state\", \"Select a State:\", choices = unique(Pop_Votes$state_name), selected = \"Alabama\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"form-group shiny-input-container\">\n<label class=\"control-label\" id=\"state-label\" for=\"state\">Select a State:</label>\n<div>\n<select id=\"state\"><option value=\"Alabama\" selected>Alabama</option>\n<option value=\"Arizona\">Arizona</option>\n<option value=\"Arkansas\">Arkansas</option>\n<option value=\"California\">California</option>\n<option value=\"Colorado\">Colorado</option>\n<option value=\"Delaware\">Delaware</option>\n<option value=\"District of Columbia\">District of Columbia</option>\n<option value=\"Florida\">Florida</option>\n<option value=\"Georgia\">Georgia</option>\n<option value=\"Hawaii\">Hawaii</option>\n<option value=\"Idaho\">Idaho</option>\n<option value=\"Illinois\">Illinois</option>\n<option value=\"Indiana\">Indiana</option>\n<option value=\"Iowa\">Iowa</option>\n<option value=\"Kansas\">Kansas</option>\n<option value=\"Kentucky\">Kentucky</option>\n<option value=\"Louisiana\">Louisiana</option>\n<option value=\"Maine\">Maine</option>\n<option value=\"Maryland\">Maryland</option>\n<option value=\"Massachusetts\">Massachusetts</option>\n<option value=\"Michigan\">Michigan</option>\n<option value=\"Minnesota\">Minnesota</option>\n<option value=\"Mississippi\">Mississippi</option>\n<option value=\"Missouri\">Missouri</option>\n<option value=\"Montana\">Montana</option>\n<option value=\"Nebraska\">Nebraska</option>\n<option value=\"Nevada\">Nevada</option>\n<option value=\"New Hampshire\">New Hampshire</option>\n<option value=\"New Jersey\">New Jersey</option>\n<option value=\"New Mexico\">New Mexico</option>\n<option value=\"New York\">New York</option>\n<option value=\"North Carolina\">North Carolina</option>\n<option value=\"North Dakota\">North Dakota</option>\n<option value=\"Ohio\">Ohio</option>\n<option value=\"Oklahoma\">Oklahoma</option>\n<option value=\"Oregon\">Oregon</option>\n<option value=\"Pennsylvania\">Pennsylvania</option>\n<option value=\"Rhode Island\">Rhode Island</option>\n<option value=\"South Carolina\">South Carolina</option>\n<option value=\"South Dakota\">South Dakota</option>\n<option value=\"Tennessee\">Tennessee</option>\n<option value=\"Texas\">Texas</option>\n<option value=\"Utah\">Utah</option>\n<option value=\"Vermont\">Vermont</option>\n<option value=\"Virginia\">Virginia</option>\n<option value=\"Washington\">Washington</option>\n<option value=\"West Virginia\">West Virginia</option>\n<option value=\"Wisconsin\">Wisconsin</option>\n<option value=\"Wyoming\">Wyoming</option></select>\n<script type=\"application/json\" data-for=\"state\" data-nonempty=\"\">{\"plugins\":[\"selectize-plugin-a11y\"]}</script>\n</div>\n</div>\n```\n:::\n:::\n\n\n{{< shiny-app url=\"https://brasidas.shinyapps.io/ElectoralCollegeCountyLevel/\" >}} -->\n\n<iframe src=\"https://brasidas.shinyapps.io/ElectoralCollegeCountyLevel/\" width=\"100%\" height=\"800px\"></iframe>\n\n\npreserve8809dc775a29c86b\n\n<!--html_preserve-->\n<script type=\"application/shiny-prerendered\" data-context=\"dependencies\">\n{\"type\":\"list\",\"attributes\":{},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"version\",\"src\",\"meta\",\"script\",\"stylesheet\",\"head\",\"attachment\",\"package\",\"all_files\",\"pkgVersion\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"html_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"selectize\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"0.12.4\"]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"file\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"www/shared/selectize\"]}]},{\"type\":\"NULL\"},{\"type\":\"character\",\"attributes\":{},\"value\":[\"js/selectize.min.js\",\"accessibility/js/selectize-plugin-a11y.min.js\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"css/selectize.bootstrap3.css\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"},{\"type\":\"character\",\"attributes\":{},\"value\":[\"shiny\"]},{\"type\":\"logical\",\"attributes\":{},\"value\":[true]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"1.7.2\"]}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"version\",\"src\",\"meta\",\"script\",\"stylesheet\",\"head\",\"attachment\",\"package\",\"all_files\",\"pkgVersion\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"html_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"selectize\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"0.12.4\"]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"file\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"www/shared/selectize\"]}]},{\"type\":\"NULL\"},{\"type\":\"character\",\"attributes\":{},\"value\":[\"js/selectize.min.js\",\"accessibility/js/selectize-plugin-a11y.min.js\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"css/selectize.bootstrap3.css\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"},{\"type\":\"character\",\"attributes\":{},\"value\":[\"shiny\"]},{\"type\":\"logical\",\"attributes\":{},\"value\":[true]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"1.7.2\"]}]}]}\n</script>\n<!--/html_preserve-->\n<!--html_preserve-->\n<script type=\"application/shiny-prerendered\" data-context=\"execution_dependencies\">\n{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"packages\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"packages\",\"version\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"data.frame\"]},\"row.names\":{\"type\":\"integer\",\"attributes\":{},\"value\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"base\",\"cli\",\"compiler\",\"datasets\",\"digest\",\"ellipsis\",\"evaluate\",\"fastmap\",\"glue\",\"graphics\",\"grDevices\",\"htmltools\",\"htmlwidgets\",\"httpuv\",\"jsonlite\",\"knitr\",\"later\",\"lifecycle\",\"magrittr\",\"methods\",\"mime\",\"promises\",\"R6\",\"Rcpp\",\"rlang\",\"rmarkdown\",\"shiny\",\"stats\",\"stringi\",\"stringr\",\"tools\",\"utils\",\"vctrs\",\"xfun\",\"xtable\",\"yaml\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"4.2.1\",\"3.6.1\",\"4.2.1\",\"4.2.1\",\"0.6.31\",\"0.3.2\",\"0.21\",\"1.1.0\",\"1.6.2\",\"4.2.1\",\"4.2.1\",\"0.5.5\",\"1.6.2\",\"1.6.5\",\"1.8.7\",\"1.40\",\"1.3.0\",\"1.0.3\",\"2.0.3\",\"4.2.1\",\"0.12\",\"1.2.0.1\",\"2.5.1\",\"1.0.10\",\"1.1.1\",\"2.16\",\"1.7.2\",\"4.2.1\",\"1.7.12\",\"1.5.0\",\"4.2.1\",\"4.2.1\",\"0.6.3\",\"0.32\",\"1.8-4\",\"2.3.5\"]}]}]}\n</script>\n<!--/html_preserve-->",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {
      "preserve8809dc775a29c86b": "\n<script type=\"application/shiny-prerendered\" data-context=\"server-extras\">\nojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {\n  quos <- rlang::enquos(...)\n  vars <- rlang::list2(...)\n  nm <- names(vars)\n  if (is.null(nm)) {\n    nm <- rep_len(\"\", length(vars))\n  }\n  mapply(function(q, nm, val) {\n    # Infer name, if possible\n    if (nm == \"\") {\n      tryCatch({\n        nm <- rlang::as_name(q)\n      }, error = function(e) {\n        code <- paste(collapse = \"\\n\", deparse(rlang::f_rhs(q)))\n        stop(\"ojs_define() could not create a name for the argument: \", code)\n      })\n    }\n    .session$output[[nm]] <- val\n    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)\n    .session$sendCustomMessage(\"ojs-export\", list(name = nm))\n    NULL\n  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)\n  invisible()\n}\n</script>\n"
    },
    "postProcess": true
  }
}